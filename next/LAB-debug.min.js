/*! LAB.js (LABjs :: Loading And Blocking JavaScript)
    v2.0b2 (c) Kyle Simpson
    MIT License
*/
(function(j){var O=j.$LAB,A="UseLocalXHR",B="AlwaysPreserveOrder",w="AllowDuplicates",C="CacheBust",l="Debug",D="BasePath",E=/^[^?#]*\//.exec(location.href)[0],F=/^\w+\:\/\/\/?[^\/]+/.exec(E)[0],i=document.head||document.getElementsByTagName("head"),P=(j.opera&&Object.prototype.toString.call(j.opera)=="[object Opera]")||("MozAppearance"in document.documentElement.style),m=function(){},G=m,s=document.createElement("script"),H=typeof s.preload=="boolean",t=H||(s.readyState&&s.readyState=="uninitialized"),I=!t&&s.async===true,Q=!t&&!I&&!P;if(j.console&&j.console.log){if(!j.console.error)j.console.error=j.console.log;m=function(a){j.console.log(a)};G=function(a,b){j.console.error(a,b)}}function J(a){return Object.prototype.toString.call(a)=="[object Function]"}function K(a){return Object.prototype.toString.call(a)=="[object Array]"}function L(a,b){var c=/^\/\/[^\/]/,d=/^\w+\:\/\//;if(c.test(a)){a=location.protocol+a}else if(!d.test(a)){if(b!=null){b=(d.test(b))?b:L(b,b[0]=="/"?F:E);a=b+a}}return a}function u(a,b){for(var c in a){if(a.hasOwnProperty(c)){b[c]=a[c]}}return b}function R(a){var b=false;for(var c=0;c<a.scripts.length;c++){if(a.scripts[c].ready&&a.scripts[c].exec_trigger){b=true;a.scripts[c].exec_trigger();a.scripts[c].exec_trigger=null}}return b}function v(a,b,c,d){a.onload=a.onreadystatechange=function(){if((a.readyState&&a.readyState!="complete"&&a.readyState!="loaded")||b[c])return;a.onload=a.onreadystatechange=null;d()}}function M(a){a.ready=a.finished=true;for(var b=0;b<a.finished_listeners.length;b++){setTimeout(a.finished_listeners[b],0)}a.ready_listeners=[];a.finished_listeners=[]}function S(d,g,e,f,h){setTimeout(function(){var a,b=g.real_src,c;if("item"in i){if(!i[0]){setTimeout(arguments.callee,25);return}i=i[0]}a=document.createElement("script");if(g.type)a.type=g.type;if(g.charset)a.charset=g.charset;if(h){if(t){if(d[l])m("start script preload: "+b);e.elem=a;if(H){a.preload=true;a.onpreload=f}else{a.onreadystatechange=function(){if(a.readyState=="loaded")f();a.onreadystatechange=null}}a.src=b}else if(h&&b.indexOf(F)==0&&d[A]){c=new XMLHttpRequest();if(d[l])m("start script preload (xhr): "+b);c.onreadystatechange=function(){if(c.readyState==4){c.onreadystatechange=function(){};e.text=c.responseText+"\n//@ sourceURL="+b;f()}};c.open("GET",b);c.send()}else{if(d[l])m("start script preload (cache): "+b);a.type="text/cache-script";v(a,e,"ready",function(){i.removeChild(a);f()});a.src=b;i.insertBefore(a,i.firstChild)}}else if(I){if(d[l])m("start script load (ordered async): "+b);a.async=false;v(a,e,"finished",f);a.src=b;i.insertBefore(a,i.firstChild)}else{if(d[l])m("start script load: "+b);v(a,e,"finished",f);a.src=b;i.insertBefore(a,i.firstChild)}},0)}function N(){var o={},T=t||Q,q=[],r={},p;o[A]=true;o[B]=false;o[w]=false;o[C]=false;o[l]=false;o[D]="";function U(a,b,c){var d;function g(){if(d!=null){M(c);d=null}}if(r[b.src].finished)return;if(!a[w])r[b.src].finished=true;d=c.elem||document.createElement("script");if(b.type)d.type=b.type;if(b.charset)d.charset=b.charset;v(d,c,"finished",g);if(c.elem){c.elem=null}else if(c.text){d.onload=d.onreadystatechange=null;d.text=c.text}else{d.src=b.real_src}i.insertBefore(d,i.firstChild);if(c.text){g()}}function V(b,c,d,g){var e,f,h=function(){c.ready_cb(c,function(){U(b,c,e)})},k=function(){c.finished_cb(c,d)};c.src=L(c.src,b[D]);c.real_src=c.src+(b[C]?((/\?.*$/.test(c.src)?"&_":"?_")+~~(Math.random()*1E9)+"="):"");if(!r[c.src])r[c.src]={items:[],finished:false};f=r[c.src].items;if(b[w]||f.length==0){e=f[f.length]={ready:false,finished:false,ready_listeners:[h],finished_listeners:[k]};S(b,c,e,((g)?function(){e.ready=true;for(var a=0;a<e.ready_listeners.length;a++){setTimeout(e.ready_listeners[a],0)}e.ready_listeners=[]}:function(){M(e)}),g)}else{e=f[0];if(e.finished){setTimeout(k,0)}else{e.finished_listeners.push(k)}}}function x(){var e,f=u(o,{}),h=[],k=0,y=false,n;function W(a,b){if(f[l])m("script preload finished: "+a.real_src);a.ready=true;a.exec_trigger=b;z()}function X(a,b){if(f[l])m("script execution finished: "+a.real_src);a.ready=a.finished=true;a.exec_trigger=null;for(var c=0;c<b.scripts.length;c++){if(!b.scripts[c].finished)return}b.finished=true;z()}function z(){while(k<h.length){if(J(h[k])){if(f[l])m("$LAB.wait() executing: "+h[k]);try{h[k]()}catch(err){if(f[l])G("$LAB.wait() error caught: ",err)}}else if(!h[k].finished){if(R(h[k]))continue;break}k++}if(k==h.length){y=false;n=false}}function Y(){if(!n||!n.scripts){h.push(n={scripts:[],finished:true})}}e={script:function(){for(var g=0;g<arguments.length;g++){(function(a,b){var c;if(!K(a)){b=[a]}for(var d=0;d<b.length;d++){Y();a=b[d];if(J(a))a=a();if(!a)continue;if(K(a)){c=[].slice.call(a);c.push(d,1);b.splice.call(b,c);d--;continue}if(typeof a=="string")a={src:a};a=u(a,{ready:false,ready_cb:W,finished:false,finished_cb:X});n.finished=false;n.scripts.push(a);V(f,a,n,(T&&y));y=true;if(f[B])e.wait()}})(arguments[g],arguments[g])}return e},wait:function(){if(arguments.length>0){for(var a=0;a<arguments.length;a++){h.push(arguments[a])}n=h[h.length-1]}else n=false;z();return e}};return{script:e.script,wait:e.wait,setOptions:function(a){u(a,f);return e}}}p={setGlobalDefaults:function(a){u(a,o);return p},setOptions:function(){return x().setOptions.apply(null,arguments)},script:function(){return x().script.apply(null,arguments)},wait:function(){return x().wait.apply(null,arguments)},queueScript:function(){q[q.length]={type:"script",args:[].slice.call(arguments)};return p},queueWait:function(){q[q.length]={type:"wait",args:[].slice.call(arguments)};return p},runQueue:function(){var a=p,b=q.length,c=b,d;for(;--c>=0;){d=q.shift();a=a[d.type].apply(null,d.args)}return a},noConflict:function(){j.$LAB=O;return p},sandbox:function(){return N()}};return p}j.$LAB=N();(function(a,b,c){if(document.readyState==null&&document[a]){document.readyState="loading";document[a](b,c=function(){document.removeEventListener(b,c,false);document.readyState="complete"},false)}})("addEventListener","DOMContentLoaded")})(this);